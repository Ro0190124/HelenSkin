@model IEnumerable<HOA_DON>
@{
    var phanquyenCookie = Context.Request.Cookies["PhanQuyen"];
    bool phanquyen = false;
}
<div class="Tb-Container mt-3">
    <div class="portfolio_button">
        <div class="row">
            <div class="col-12">
                <a asp-controller="DonHang" asp-action="Index"><button>Chờ xác nhận </button></a>
                <a asp-controller="DonHang" asp-action="DaXacNhan"><button class="active">Chờ giao</button></a>
                <a asp-controller="DonHang" asp-action="DangGiao"><button>Đang giao</button></a>
                <a asp-controller="DonHang" asp-action="DaGiao"><button>Đã giao</button></a>
                <a asp-controller="DonHang" asp-action="DaHuy"><button>Đã hủy</button></a>
            </div>
        </div>
    </div>
    <table class="table_user responsive-table">
        <thead>
            <tr>
                <th> ID</th>
                <th> Họ Tên</th>
                <th> Đơn Giá</th>
                <th> Ngày đặt</th>
                <th> Trạng Thái</th>
                <th> Ghi Chú</th>
                @if (phanquyen)
                {
                    <th> Chỉnh sửa</th>
                }
               
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                string status;
                if (item.TrangThai == 1)
                {
                    status = "Chờ Giao";
                }
                else
                {
                    status = "";
                }

                // Lấy index của đơn hàng trong danh sách để truy xuất giá tương ứng
                int index = Model.ToList().FindIndex(x => x.MaHD == item.MaHD);

                <tr>
                    <td>@item.MaHD</td>
                    <td>@item.GIO_HANG.NGUOI_DUNG.TenND</td>
                    <td>@ViewBag.TotalPrices[index]</td> <!-- Hiển thị giá tương ứng -->
                    <td>@item.NgayTao.ToShortDateString()</td>
                    <td>@status</td>
                    <td>@item.GhiChu</td>
                    @if (phanquyen)
                    {
                         <td class="ND_Table_Icon d-flex justify-content-around">
                        <div class="bgr-x">
                            <a class="btn btn-success" asp-controller="DonHang" asp-action="Accept" asp-route-id="@item.MaHD">
                                Xác Nhận
                            </a>
                        </div>
                        <div class="bgr-x">
                            <a class="btn btn-danger delete-btn" asp-controller="DonHang" asp-action="Cancel" asp-route-id="@item.MaHD">
                                Hủy
                            </a>
                        </div>
                        <div>
                            <a class="btn btn-info" asp-controller="DonHang" asp-action="ChiTietDonHang" asp-route-id="@item.MaHD">
                                Chi tiết
                            </a>
                        </div>
                        </td>
                    }
                   
                </tr>
            }
        </tbody>
        </tbody>
    </table>
</div>

