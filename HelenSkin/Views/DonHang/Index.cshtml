@model IEnumerable<HOA_DON>
@{
    bool phanquyenCookie = bool.Parse(Context.Request.Cookies["PhanQuyen"]);
}
<div class="Tb-Container mt-3">
    <div class="portfolio_button">
        <div class="row">
            <div class="col-12">

                <a asp-controller="DonHang" asp-action="Index"><button class="active" >Chờ xác nhận </button></a>
                <a class="active" asp-controller="DonHang" asp-action="DaXacNhan"><button>Chờ giao</button></a>
                <a asp-controller="DonHang" asp-action="DangGiao"><button>Đang giao</button></a>
                <a asp-controller="DonHang" asp-action="DaGiao"><button>Đã giao</button></a>
                <a asp-controller="DonHang" asp-action="DaHuy"><button>Đã hủy</button></a>
            </div>
        </div>
    </div>
    <table class="table_user responsive-table">
        <thead>
            <tr>
                <th> ID</th>
                <th> Họ Tên</th>
                <th> Đơn Giá</th>
                <th> Ngày Đặt</th>
                <th> Trạng Thái</th>
                <th> Ghi Chú</th>
                @if (phanquyenCookie)
                {
                <th> Chỉnh sửa</th>
                }
                <th>Chi Tiết</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                string status;
                if (item.TrangThai == 0)
                {
                    status = "Chờ xác nhận";
                }
                else
                {
                    status = "Đã xác nhận";
                }

                // Lấy index của đơn hàng trong danh sách để truy xuất giá tương ứng
                int index = Model.ToList().FindIndex(x => x.MaHD == item.MaHD);

                <tr>
                    <td>@item.MaHD</td>
                    <td>@item.GIO_HANG.NGUOI_DUNG.TenND</td>
                    <td>@ViewBag.TotalPrices[index]</td> <!-- Hiển thị giá tương ứng -->
                    <td>@item.NgayTao.ToShortDateString()</td>
                    <td>@status</td>
                    <td>@item.GhiChu</td>

                    @if (phanquyenCookie)
                    {
                        
                        <td class="ND_Table_Icon d-flex justify-content-around">
                            <div class="bgr-x">
                                <a class="btn btn-success" asp-controller="DonHang" asp-action="Accept" asp-route-id="@item.MaHD">
                                    Xác Nhận
                                </a>
                            </div>
                            <div class="bgr-x">
                                <a class="btn btn-danger delete-btn" asp-controller="DonHang" asp-action="Cancel" asp-route-id="@item.MaHD">
                                    Hủy
                                </a>
                            </div>
                          
                        </td>
                    }
                    <td>
                        <a asp-controller="DonHang" asp-action="ChiTietDonHangND" asp-route-id="@item.MaHD">
                            <i class="fas fa-list"></i>
                        </a>
                    </td>
                </tr>

            }
        </tbody>
        </tbody>
    </table>
</div>

